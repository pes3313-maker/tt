<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ÌçºÏ¶ê ÏúàÎèÑÏö∞ ‚Äî Drag & Snap</title>
  <style>
    :root{
      --sky:#cfe6ff; --sky2:#f6f0ff; --ink:#222; --muted:#556;
      --chrome:#6374d6; --chrome-dark:#485ac4; --window:#f6f8ff;
      --ok:#35c26b; --warn:#ffb74d; --bad:#ff6b6b;
      --shadow: 0 12px 30px rgba(0,0,0,.20);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family: "Pretendard", system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, Arial, sans-serif;color:var(--ink)}
    body{overflow:hidden; background:linear-gradient(180deg,var(--sky),var(--sky2) 65%)}

    /* Decorative clouds */
    .cloud{position:absolute; background:linear-gradient(180deg,#fff,#f1f4ff); border-radius:999px; filter:drop-shadow(0 8px 20px rgba(0,0,0,.1)); opacity:.75}
    .cloud:before,.cloud:after{content:""; position:absolute; background:inherit; border-radius:inherit}
    .cloud.small{width:120px;height:60px}
    .cloud.small:before{width:70px;height:70px; left:-20px; top:-18px}
    .cloud.small:after{width:80px;height:80px; right:-22px; top:-26px}
    .cloud.big{width:220px;height:110px}
    .cloud.big:before{width:120px;height:120px; left:-30px; top:-28px}
    .cloud.big:after{width:140px;height:140px; right:-32px; top:-38px}

    /* Toolbar */
    .toolbar{position:fixed; left:12px; top:12px; display:flex; gap:8px; z-index:100}
    .btn{background:linear-gradient(180deg,#4cc66e,#2d9f53); color:#fff; border:1px solid #1f7c3f; padding:8px 12px; border-radius:8px; font-weight:800; cursor:pointer}
    .btn.secondary{background:linear-gradient(180deg,#7aa0ff,#5876e8); border-color:#3c55b8}
    .status{background:#ffffffc9; backdrop-filter:blur(6px); border:1px solid #dfe4ff; padding:8px 12px; border-radius:8px; font-weight:700}

    /* Dropzone board */
    .board{position:fixed; inset:80px 12px 12px 12px; border-radius:16px; background:linear-gradient(180deg,#f7fbff,#eef4ff); border:1px solid #dfe4ff; box-shadow:var(--shadow)}
    .grid{position:absolute; inset:12px; border-radius:12px; border:1px dashed #c6cffc}

    /* Target slots (invisible silhouettes) */
    .slot{position:absolute; width:220px; height:140px; border-radius:12px; border:2px dashed #b7c4ff; background:repeating-linear-gradient(45deg,#f7f9ff,#f7f9ff 8px,#f1f4ff 8px,#f1f4ff 16px); opacity:.7}
    .slot.correct{border-color:#35c26b; background:rgba(53,194,107,.12)}

    /* Draggable windows (pieces) */
    .win{position:absolute; width:220px; min-height:140px; background:var(--window); border:1px solid #cad3ff; border-radius:12px; overflow:hidden; box-shadow:var(--shadow); touch-action:none}
    .titlebar{display:flex; align-items:center; gap:8px; padding:8px 10px; color:#fff; background:linear-gradient(180deg, var(--chrome), var(--chrome-dark)); cursor:grab; user-select:none}
    .titlebar:active{cursor:grabbing}
    .titlebar strong{font-size:14px}
    .titlebar .btns{margin-left:auto; display:flex; gap:6px}
    .tb{width:26px;height:22px; border-radius:4px; background:rgba(255,255,255,.18); display:grid; place-items:center; border:1px solid rgba(255,255,255,.3); font-weight:900}
    .content{padding:12px; font-size:13px; color:#334}

    /* Success overlay */
    .done{position:fixed; inset:0; display:none; place-items:center; z-index:300;}
    .done.show{display:grid}
    .card{background:#fff; border:1px solid #dfe4ff; border-radius:16px; padding:24px 28px; box-shadow:var(--shadow); text-align:center}
    .card h2{margin:0 0 8px}
    .card p{margin:0 0 16px; color:var(--muted)}

    /* Confetti */
    .confetti{position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:250}
    .confetti i{position:absolute; width:8px; height:14px; background:linear-gradient(180deg,#ffd07a,#ff86d8,#7fe0ff); transform:translateY(-20vh) rotate(0deg); animation:fall 2.2s linear forwards; border-radius:2px}
    @keyframes fall{to{transform:translateY(120vh) rotate(380deg)}}

    /* Mobile hint */
    @media (max-width: 768px){
      .slot, .win{width:180px; height:120px}
      .board{inset:96px 8px 8px 8px}
    }
  </style>
</head>
<body>
  <!-- clouds -->
  <div class="cloud small" style="top:8vh; left:6vw"></div>
  <div class="cloud big" style="top:14vh; left:24vw"></div>
  <div class="cloud small" style="top:10vh; right:8vw"></div>
  <div class="cloud big" style="top:22vh; right:18vw"></div>

  <!-- Controls -->
  <div class="toolbar">
    <button class="btn" id="shuffle">Shuffle</button>
    <button class="btn secondary" id="reset">Reset</button>
    <div class="status" id="status">0 / 6 ÎßûÏ∂§</div>
  </div>

  <!-- Board & Slots -->
  <div class="board" id="board" aria-label="puzzle-board">
    <div class="grid" id="grid"></div>
  </div>

  <!-- Success -->
  <div class="done" id="done">
    <div class="card">
      <h2>ÏôÑÏÑ±! üéâ</h2>
      <p>Î™®Îì† ÏúàÎèÑÏö∞ Ï°∞Í∞ÅÏùÑ Ï†ïÌôïÌïú ÏúÑÏπòÏóê ÎßûÏ∑ÑÏäµÎãàÎã§.</p>
      <button class="btn" id="again">Îã§Ïãú ÌïòÍ∏∞</button>
    </div>
  </div>

  <script>
    // ----- Config -----
    const PIECES = [
      {id:'a', title:'Paint', text:'Ïó∞ÌïÑ / Î∏åÎü¨Ïãú / ÎèÑÌòï'},
      {id:'b', title:'Viewer', text:'Ïù¥ÎØ∏ÏßÄ Î∑∞Ïñ¥'},
      {id:'c', title:'Memo', text:'Î©îÎ™®Ï∞Ω'},
      {id:'d', title:'Media Player', text:'Ïû¨ÏÉù / ÏùºÏãúÏ†ïÏßÄ'},
      {id:'e', title:'Smile!', text:'( Õ°¬∞ Õú ñ Õ°¬∞ )'},
      {id:'f', title:'Cool Fish', text:'üêü ÌååÎã•ÌååÎã•'}
    ];

    // Target slot layout (relative to board)
    const SLOT_LAYOUT = [
      {id:'a', x:40,  y:20},
      {id:'b', x:280, y:20},
      {id:'c', x:520, y:20},
      {id:'d', x:40,  y:190},
      {id:'e', x:280, y:190},
      {id:'f', x:520, y:190}
    ];

    const board = document.getElementById('board');
    const grid = document.getElementById('grid');
    const statusEl = document.getElementById('status');
    const doneEl = document.getElementById('done');

    const SLOTS = new Map();
    const WINS  = new Map();
    let solved = 0;

    // Create slots
    function createSlots(){
      SLOT_LAYOUT.forEach(s=>{
        const el = document.createElement('div');
        el.className = 'slot';
        el.dataset.id = s.id;
        el.style.left = s.x + 'px';
        el.style.top  = s.y + 'px';
        grid.appendChild(el);
        SLOTS.set(s.id, el);
      });
    }

    // Create windows (pieces)
    function createWindows(){
      PIECES.forEach((p,i)=>{
        const w = document.createElement('div');
        w.className = 'win';
        w.dataset.id = p.id;
        w.style.left = (Math.random()*(window.innerWidth-260) + 20) + 'px';
        w.style.top  = (Math.random()*(window.innerHeight-260) + 80) + 'px';
        w.innerHTML = `
          <div class="titlebar" data-drag>
            <strong>${p.title}</strong>
            <div class="btns"><div class="tb">√ó</div></div>
          </div>
          <div class="content">${p.text}</div>
        `;
        document.body.appendChild(w);
        makeDraggable(w);
        WINS.set(p.id, w);
      });
    }

    function updateStatus(){
      statusEl.textContent = `${solved} / ${PIECES.length} ÎßûÏ∂§`;
    }

    function showConfetti(){
      const layer = document.createElement('div');
      layer.className = 'confetti';
      for(let i=0;i<120;i++){
        const b = document.createElement('i');
        b.style.left = Math.random()*100 + 'vw';
        b.style.animationDelay = (Math.random()*0.8)+'s';
        b.style.opacity = (0.6 + Math.random()*0.4).toFixed(2);
        layer.appendChild(b);
      }
      document.body.appendChild(layer);
      setTimeout(()=>layer.remove(), 2800);
    }

    function checkComplete(){
      if(solved === PIECES.length){
        showConfetti();
        doneEl.classList.add('show');
      }
    }

    // Dragging & snapping
    function makeDraggable(win){
      const bar = win.querySelector('[data-drag]');
      let sx=0, sy=0, sl=0, st=0, dragging=false;

      const onDown = e=>{
        dragging = true; win.setPointerCapture(e.pointerId);
        sx = e.clientX; sy = e.clientY; sl = parseInt(win.style.left)||0; st = parseInt(win.style.top)||0;
        win.style.zIndex = 200 + Date.now()%1000;
      };
      const onMove = e=>{
        if(!dragging) return;
        const dx=e.clientX-sx, dy=e.clientY-sy;
        const nx=Math.max(0, Math.min(window.innerWidth - win.offsetWidth, sl+dx));
        const ny=Math.max(0, Math.min(window.innerHeight - win.offsetHeight, st+dy));
        win.style.left = nx + 'px';
        win.style.top  = ny + 'px';
      };
      const onUp = e=>{
        if(!dragging) return; dragging=false; try{win.releasePointerCapture(e.pointerId)}catch(_){ }
        trySnap(win);
      };

      bar.addEventListener('pointerdown', onDown);
      window.addEventListener('pointermove', onMove);
      window.addEventListener('pointerup', onUp);

      // close button just shakes to hint puzzle
      win.querySelector('.tb').addEventListener('click', ()=>{
        win.animate([
          {transform:'translateX(0)'},
          {transform:'translateX(-6px)'},
          {transform:'translateX(6px)'},
          {transform:'translateX(0)'}
        ], {duration:220});
      });
    }

    function rectCenter(el){
      const r = el.getBoundingClientRect();
      return {x:r.left + r.width/2, y:r.top + r.height/2};
    }

    function trySnap(win){
      const id = win.dataset.id;
      const slot = SLOTS.get(id);
      const wc = rectCenter(win), sc = rectCenter(slot);
      const dist = Math.hypot(wc.x - sc.x, wc.y - sc.y);
      const threshold = Math.min(win.offsetWidth, win.offsetHeight) * 0.45; // generous
      if(dist < threshold){
        // snap exactly to slot position
        const br = board.getBoundingClientRect();
        const sr = slot.getBoundingClientRect();
        win.style.left = (sr.left - 0) + 'px';
        win.style.top  = (sr.top  - 0) + 'px';
        // lock it
        win.style.pointerEvents = 'none';
        slot.classList.add('correct');
        solved += 1; updateStatus(); checkComplete();
      }
    }

    // Shuffle = randomize pieces positions & unlock
    function shufflePieces(){
      solved = 0; updateStatus();
      document.querySelectorAll('.slot').forEach(s=>s.classList.remove('correct'));
      WINS.forEach(win=>{
        win.style.pointerEvents='auto';
        win.style.left = (Math.random()*(window.innerWidth-260) + 20) + 'px';
        win.style.top  = (Math.random()*(window.innerHeight-260) + 80) + 'px';
      });
      doneEl.classList.remove('show');
    }

    function resetAll(){
      // remove windows & slots and recreate
      document.querySelectorAll('.win').forEach(w=>w.remove());
      document.querySelectorAll('.slot').forEach(s=>s.remove());
      SLOTS.clear(); WINS.clear(); solved=0; updateStatus();
      createSlots(); createWindows();
      doneEl.classList.remove('show');
    }

    // Init
    createSlots();
    createWindows();
    updateStatus();

    // Controls
    document.getElementById('shuffle').addEventListener('click', shufflePieces);
    document.getElementById('reset').addEventListener('click', resetAll);
    document.getElementById('again').addEventListener('click', ()=>{shufflePieces();});

    // Resize hint: keep slots anchored; windows stay absolute (no need to relayout)
    window.addEventListener('resize', ()=>{
      // no-op by design; this keeps the puzzle feel even on orientation changes
    });
  </script>
</body>
</html>


